# 第2章 链路层
　　1、链路层主要有三个目的：（1）为IP模块发送和接收P数据报；（2）为ARP模块发送ARP请求和接收ARP应答；（3）为RARP发送RARP请求和接收RARP应答。TCP/IP支持多种不同的链路层协议，这取决于网络所使用的硬件。  
　　2、以太网是一个标准，数字设备公司（Digital Equipment Corp）、英特尔公司（Intel Corp）和Xerox公司在1982年联合公布。当今TCP/IP采用的主要的局域网技术。采用CSMA/CD的媒体接入方法（带冲突检测的载波侦听多路接入）。速率为10Mb/s，地址位48bit。  
　　3、以太网IP数据报的封装是在RFC894[Horning 1984]中定义的。主机需求RFC要求每台Internet主机都与一个10Mb/s的以太网电缆相连接。  
　　4、最长使用的封装格式是RFC894定义的格式。两种帧格式采用48bit(6字节)的目的地址和源地址。也被称为硬件地址。  
　　5、CRC字段用于帧内后续字节差错的循环冗余码检验（检验和）（它也被称为FCS或帧检验序列）。  
　　6、802.3规定数据部分必须至少为38字节，以太网要求最少要有46字节。  
　　7、RFC893[Leffler and Karels 1984]描述了另一种用于以太网的封装格式，称作尾部封装（trailer encapsulation）。现在尾部封装已经遭到反对。  
　　7、SLIP：Serial Line IP。一种在串行线路上对IP数据报进行封装的简单形式。一种广泛使用的协议。帧格式：IP数据报以一个称作END(0xc0)的特殊字符结束。如果IP报文中某个字符为END，那么就要连续传输两个字节0xdb和0xdc来取代它。如果IP报文中的某个字符为SLIP的ESC字符，连续传输两个字节0xdb和0xdd来取代它。缺陷：每一端必须知道对方的IP地址。数据帧中没有类型字段，如果一条串行线路用于SLIP，那么它不能同时使用其他协议。SLIP没有在数据帧中加上检验和。  
　　8、串行线路的速率通常较低，通信经常是交互的，因此在SLIP线路上有许多小的TCP分组进行交换。CSLIP（压缩SLIP）能够缩短交互响应的事件。  
　　9、点对点协议PPP修改了SLIP协议中所有缺陷。PPP包括：在串行链路上封装IP数据报的方法（PPP既支持数据为8位和无奇偶检验的异步模式，如大多数计算机上都普遍存在的串行接口，还支持面向比特的同步链接）；建立、配置及测试数据链路的链路控制协议LCP:Link Control Protocol，它允许通信双方进行协商，以确定不同的选项。针对不同网络层协议的网络控制协议NCP:Net Control Protocol体系。  
　　10、点对点协议每一帧都以标志字符0x7e开始和结束。紧接着是一个地址字节，值始终是0xff，然后是一个值为0x03的控制字节。接下来是协议字段：0x0021表示信息字段是一个IP数据报，0xc021表示信息字段是链路控制数据，0x8021表示信息字段是网络控制数据。然后是CRC字段（或FCS，帧检验序列），是一个循环冗余检验码，以检测数据帧中的错误。由于标志字符的值是0x7e时，因此当该字符出现在信息字段中时，PPP需要对它进行转义。同步链路中该过程通过称作比特填充的硬件技术来完成，异步链路中，特殊字符0x7d用作转义字符。  
　　11、PPP经常用于低速的串行链路，因此减少每一帧的字节数可以降低应用程序的交互时延。  
　　12、PPP比SLIP具有的优点：PPP支持在单根串行线路上运行多种协议，不只是IP协议；每一帧都有循环冗余检验；通信双方可以进行IP地址的动态协商（使用IP网络控制协议）；与CSLIP类似，对TCP和IP报文首部进行压缩；链路控制协议可以对多个数据链路选项进行设置。使用SLIP的用户更多。  
　　13、环回接口Loopback Interface，大多数产品都支持，以允许运行在同一台主机上的客户程序和服务器程序通过TCP/IP进行通信。A类网络号127是为其预留的，大多数系统把127.0.0.1分配给这个接口并命名为localhost。一个传给环回接口的IP数据报不能在任何网络上出现。  
　　14、以太网和802.3对数据帧的长度都有一个限制，其最大值分别是1500和1492字节。链路层的这个特性称作MTU，最大传输单元。若数据长度大于MTU则需要进行分片。  
　　15、同一个网络的两台主机互相通信时，网络的MTU很重要。两台主机之间的通信要通过多个网络，则通信主机路径中的最小MTU很重要，被称作为路径MTU。路径MTU不一定是常数，取决于当时所选择的路由，而A到B与B到A的路由不一定相同。  
　　14、以太网和802.3对数据帧的长度都有一个限制，其最大值分别是1500和1492字节。链路层的这个特性称作MTU，最大传输单元。若数据长度大于MTU则需要进行分片。  
　　14、以太网和802.3对数据帧的长度都有一个限制，其最大值分别是1500和1492字节。链路层的这个特性称作MTU，最大传输单元。若数据长度大于MTU则需要进行分片。  
**习题**  
1、windows下的netstat命令：  
netstat  
协议 | 本地地址 | 外部地址 | 状态  
NETSTAT [-a] [-b] [-e] [-n] [-o] [-p proto] [-r] [-s] [-v] [interval]  
-a | 显示所有连接和监听端口。  
-b | 显示包含于创建每个连接或监听端口的可执行组件。在某些情况下已知可执行组件拥有多个独立组件，并且在这些情况下包含于创建连接或监听端口的组件序列被显示。这种情况下，可执行组件名在底部的 [] 中，顶部是其调用的组件等等，直到TCP/IP部分。注意此选项可能需要很长时间，如果没有足够权限可能失败。  
-e | 显示以太网统计信息。此选项可以与-s选项组合使用。  
-n | 以数字形式显示地址和端口号。  
-o | 显示与每个连接相关的所属进程 ID 。  
-p proto | 显示 proto 指定的协议的连接；proto 可以是下列协议之一:TCP、UDP、TCPv6或UDPv6。如果与-s选项一起使用以显示按协议统计信息，proto可以是下列协议之一:IP、IPv6、ICMP、ICMPv6、TCP、TCPv6、UDP 或 UDPv6。  
-r | 显示路由表。  
-s | 显示按协议统计信息。默认地，显示 IP、IPv6、ICMP、ICMPv6、TCP、TCPv6、UDP 和UDPv6 的统计信息；-p 选项用于指定默认情况的子集。  
-v | 与-b选项一起使用时将显示包含于为所有可执行组件创建连接或监听端口的组件。  
interval | 重新显示选定统计信息，每次显示之间暂停时间间隔( 以秒计)。按CTRL+C停止重新显示统计信息。如果省略，netstat 显示当前配置信息( 只显示一次)